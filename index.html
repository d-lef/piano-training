<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Piano Note Trainer</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect x='5' y='20' width='90' height='60' rx='4' fill='%23333'/><rect x='10' y='25' width='11' height='50' fill='white' rx='2'/><rect x='23' y='25' width='11' height='50' fill='white' rx='2'/><rect x='36' y='25' width='11' height='50' fill='white' rx='2'/><rect x='49' y='25' width='11' height='50' fill='white' rx='2'/><rect x='62' y='25' width='11' height='50' fill='white' rx='2'/><rect x='75' y='25' width='11' height='50' fill='white' rx='2'/><rect x='17' y='25' width='8' height='30' fill='%23333' rx='1'/><rect x='30' y='25' width='8' height='30' fill='%23333' rx='1'/><rect x='56' y='25' width='8' height='30' fill='%23333' rx='1'/><rect x='69' y='25' width='8' height='30' fill='%23333' rx='1'/><rect x='82' y='25' width='8' height='30' fill='%23333' rx='1'/></svg>">
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/vexflow@4.2.3/build/cjs/vexflow.js"></script>
</head>
<body>
    <a href="help.html" id="help-btn" title="Help &amp; Instructions">?</a>
    <div id="app">
        <!-- Settings Panel -->
        <div id="settings-panel">
            <div class="setting-group">
                <label title="Which clef to display notes on">Clef:</label>
                <select id="clef-select" title="Treble (G clef), Bass (F clef), or both randomly">
                    <option value="treble">Treble</option>
                    <option value="bass">Bass</option>
                    <option value="both">Both</option>
                </select>
            </div>
            <div class="setting-group">
                <label title="Limit which notes appear in training">Range:</label>
                <select id="range-min" title="Lowest note to practice"></select>
                <span>to</span>
                <select id="range-max" title="Highest note to practice"></select>
            </div>
            <div class="setting-group">
                <label class="toggle" title="Show the note name below the staff">
                    <input type="checkbox" id="show-note-names">
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Note hints</span>
                </label>
            </div>
            <div class="setting-group">
                <label class="toggle" title="Show note names on piano keys">
                    <input type="checkbox" id="keyboard-labels-toggle">
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Key labels</span>
                </label>
            </div>
            <div class="setting-group">
                <label class="toggle" title="Include sharps and flats (C#, D#, etc.)">
                    <input type="checkbox" id="accidentals-toggle">
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Accidentals</span>
                </label>
            </div>
            <div class="setting-group">
                <label class="toggle" title="Prioritize notes you struggle with: missed notes and slow responses appear more often">
                    <input type="checkbox" id="smart-repetition-toggle" checked>
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Smart</span>
                </label>
            </div>
            <div class="setting-group">
                <label class="toggle" title="Show response time counter (still tracks in background when hidden)">
                    <input type="checkbox" id="timer-toggle">
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Timer</span>
                </label>
            </div>
            <div class="setting-group">
                <label class="toggle" title="Play piano sound when keys are pressed">
                    <input type="checkbox" id="sound-toggle" checked>
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Sound</span>
                </label>
            </div>
            <div class="setting-group">
                <label class="toggle" title="Switch between dark and light theme">
                    <input type="checkbox" id="theme-toggle" checked>
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Dark</span>
                </label>
            </div>
            <button id="new-session-btn" title="Reset all scores and start fresh">New Session</button>
        </div>

        <!-- Main Layout with Side Panel -->
        <div id="main-layout">
            <!-- Side Panels (Left) -->
            <div id="side-panels">
                <div id="misses-panel">
                    <div class="panel-title">Mistakes</div>
                    <div class="panel-empty">None yet</div>
                </div>
                <div id="slowest-panel">
                    <div class="panel-title">Slowest</div>
                    <div class="panel-empty">None yet</div>
                </div>
                <button id="clear-stats-btn" title="Clear mistakes and slowest statistics (resets smart repetition)">Clear Stats</button>
            </div>

            <!-- Center Content -->
            <div id="center-content">
                <!-- Score Strip -->
                <div id="score-strip">
                    <div class="score-item">
                        <span class="label">Correct:</span>
                        <span id="correct-count">0</span>
                    </div>
                    <div class="score-item">
                        <span class="label">Wrong:</span>
                        <span id="wrong-count">0</span>
                    </div>
                    <div class="score-item">
                        <span class="label">Accuracy:</span>
                        <span id="accuracy">--%</span>
                    </div>
                    <div class="score-item">
                        <span class="label">Streak:</span>
                        <span id="streak">0</span>
                    </div>
                </div>

                <!-- Staff Display -->
                <div id="staff-container">
                    <div id="start-overlay">
                        <button id="start-btn">Start</button>
                    </div>
                    <button id="pause-toggle-btn" class="hidden" title="Pause/Continue session">‚è∏</button>
                    <div id="staff"></div>
                    <div id="staff-footer">
                        <div id="note-label"></div>
                        <div id="timer">0.0s</div>
                    </div>
                </div>

                <!-- Feedback Overlay -->
                <div id="feedback" class="hidden"></div>

                <!-- Piano Keyboard -->
                <div id="keyboard-container">
                    <div id="keyboard"></div>
                </div>

                <!-- Keyboard Hints -->
                <div id="keyboard-hints">
                    <span>PC Keyboard: Z X C V B N M = white keys (C D E F G A B) | S D G H J = black keys | Arrow Up/Down = octave</span>
                </div>
            </div>
        </div>
    </div>

    <script src="notes.js"></script>
    <script src="staff.js"></script>
    <script src="keyboard.js"></script>
    <script src="storage.js"></script>
    <script src="app.js"></script>
</body>
</html>
